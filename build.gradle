plugins {
    id "com.github.node-gradle.node" version "7.0.0"
}

node {
    version = '12.22.12'
    download = true
}

task cleanDist(type: NpxTask) {
    dependsOn npmInstall
    command = 'rimraf'
    args = ['./dist']
}

task compileTypeScript(type: NpxTask) {
    dependsOn npmInstall
    command = 'tsc'
    inputs.files('tsconfig.json', 'tsconfig.app.json')
    // inputs.dir('src') //TODO: perguntar ao professor em que é que esta linha seria benéfica
    inputs.dir(fileTree("node_modules").exclude(".cache"))
    outputs.dir('dist')
}

task build {
    dependsOn cleanDist, compileTypeScript
}

task docsGeneration(type: NpxTask) {
    command = 'jsdoc'
    args = ['-r', './dist', '-d', './jsdocs']
}

task runUnitTests(type: NpxTask) {
    command = 'jest'
}

task generateUnitTestsCoverageReport(type: NpxTask) {
    command = 'jest'
    args = ['--coverage', '--coverageReporters=\"text\"', '--coverageReporters=\"html\"', '--coverageReporters=\"json\"']
}

task runAPITests(type: NpxTask) {
    
}





